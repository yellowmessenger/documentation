"use strict";(self.webpackChunkbenthos=self.webpackChunkbenthos||[]).push([[54211],{603905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return h}});var r=a(667294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=r.createContext({}),s=function(e){var t=r.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},m=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},k=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),c=s(a),k=n,h=c["".concat(p,".").concat(k)]||c[k]||u[k]||o;return a?r.createElement(h,i(i({ref:t},m),{},{components:a})):r.createElement(h,i({ref:t},m))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=k;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[c]="string"==typeof e?e:n,i[1]=l;for(var s=2;s<o;s++)i[s]=a[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}k.displayName="MDXCreateElement"},314767:function(e,t,a){a.r(t),a.d(t,{assets:function(){return m},contentTitle:function(){return p},default:function(){return k},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return c}});var r=a(487462),n=a(263366),o=(a(667294),a(603905)),i=["components"],l={title:"Azure AD integration",sidebar_label:"Azure AD"},p=void 0,s={unversionedId:"platform_concepts/appConfiguration/azure-ad",id:"platform_concepts/appConfiguration/azure-ad",title:"Azure AD integration",description:"Azure Active Directory (Azure AD) enhances user management by enabling Single Sign-On (SSO) and personalized app experiences through the use of organizational data APIs. This integration also offers IT administrators comprehensive control over application and resource access, using advanced security features like Multi-Factor Authentication (MFA) and conditional access.",source:"@site/docs/platform_concepts/appConfiguration/azure-ad.md",sourceDirName:"platform_concepts/appConfiguration",slug:"/platform_concepts/appConfiguration/azure-ad",permalink:"/docs/platform_concepts/appConfiguration/azure-ad",draft:!1,tags:[],version:"current",frontMatter:{title:"Azure AD integration",sidebar_label:"Azure AD"},sidebar:"platform_concepts",previous:{title:"AWS-S3",permalink:"/docs/platform_concepts/appConfiguration/aws-s3"},next:{title:"CleverTap",permalink:"/docs/platform_concepts/appConfiguration/clevertap"}},m={},c=[{value:"Key Features:",id:"key-features",level:4},{value:"Yellow.ai Compatibility:",id:"yellowai-compatibility",level:4},{value:"Authentication Flow:",id:"authentication-flow",level:4},{value:"<strong>App Registration on Azure AD</strong>",id:"app-registration-on-azure-ad",level:2},{value:"<strong>Steps to Configure the App in Azure AD</strong>",id:"steps-to-configure-the-app-in-azure-ad",level:3},{value:"<strong>Steps to Integrate Azure App with Yellow.ai Bot</strong>",id:"steps-to-integrate-azure-app-with-yellowai-bot",level:3},{value:"<strong>Authentication Workflow</strong>",id:"authentication-workflow",level:3},{value:"<strong>Access Token Usage</strong>",id:"access-token-usage",level:4},{value:"<strong>Retrieve User Profile via Graph API</strong>",id:"retrieve-user-profile-via-graph-api",level:3},{value:"<strong>Request:</strong>",id:"request",level:4},{value:"<strong>Response Example:</strong>",id:"response-example",level:4},{value:"<strong>Other Useful Graph APIs</strong>",id:"other-useful-graph-apis",level:3},{value:"<strong>Resources for Exploration</strong>",id:"resources-for-exploration",level:3},{value:"App Registration on AAD",id:"app-registration-on-aad",level:2},{value:"Steps to configure App in Azure AD",id:"steps-to-configure-app-in-azure-ad",level:2},{value:"Steps to integrate Azure app with yellow.ai bot:",id:"steps-to-integrate-azure-app-with-yellowai-bot-1",level:2},{value:"References",id:"references",level:2}],u={toc:c};function k(e){var t=e.components,a=(0,n.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Azure Active Directory (Azure AD) enhances user management by enabling ",(0,o.kt)("strong",{parentName:"p"},"Single Sign-On (SSO)")," and personalized app experiences through the use of organizational data APIs. This integration also offers IT administrators comprehensive control over application and resource access, using advanced security features like ",(0,o.kt)("strong",{parentName:"p"},"Multi-Factor Authentication (MFA)")," and conditional access."),(0,o.kt)("h4",{id:"key-features"},"Key Features:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"SSO for Seamless Access:")," Azure AD supports integration with over 2,800 pre-configured Software as a Service (SaaS) applications, simplifying access management across systems.  "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Security and Personalization:")," Use organization-specific data to create secure, tailored experiences.")),(0,o.kt)("h4",{id:"yellowai-compatibility"},"Yellow.ai Compatibility:"),(0,o.kt)("p",null,"Yellow.ai comes pre-integrated with:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Active Directory Federation Services (ADFS)"),"  "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Generic OAuth")," implementation  ")),(0,o.kt)("p",null,"This ensures secure authentication while supporting diverse organizational needs."),(0,o.kt)("h4",{id:"authentication-flow"},"Authentication Flow:"),(0,o.kt)("p",null,"When ADFS is enabled:  "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The bot redirects you to the ",(0,o.kt)("strong",{parentName:"li"},"Active Directory login page")," for credential input.  "),(0,o.kt)("li",{parentName:"ol"},"AD validates the credentials.  "),(0,o.kt)("li",{parentName:"ol"},"Upon successful authentication, ADFS triggers a callback to Yellow.ai to indicate the result.  "),(0,o.kt)("li",{parentName:"ol"},"If authentication succeeds, ADFS generates:  ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"An ",(0,o.kt)("strong",{parentName:"li"},"authentication token"),"  "),(0,o.kt)("li",{parentName:"ul"},"A ",(0,o.kt)("strong",{parentName:"li"},"refresh token"),"  "),(0,o.kt)("li",{parentName:"ul"},"The token\u2019s ",(0,o.kt)("strong",{parentName:"li"},"time-to-live (TTL)"),"  ")))),(0,o.kt)("p",null,"These tokens allow secure access while maintaining control over session duration."),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"app-registration-on-azure-ad"},(0,o.kt)("strong",{parentName:"h2"},"App Registration on Azure AD")),(0,o.kt)("p",null,"To connect Azure AD with your Yellow.ai bot, you must first register an app in Azure AD and retrieve the following details:  "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Client ID")," (Application ID)  "),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Tenant ID"),"  "),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Client Secret"))),(0,o.kt)("h3",{id:"steps-to-configure-the-app-in-azure-ad"},(0,o.kt)("strong",{parentName:"h3"},"Steps to Configure the App in Azure AD")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Log in to ",(0,o.kt)("a",{parentName:"p",href:"https://portal.azure.com"},"Azure Portal")," and navigate to ",(0,o.kt)("strong",{parentName:"p"},"Active Directory")," > ",(0,o.kt)("strong",{parentName:"p"},"App Registrations"),".",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/CcHq8fL.png",alt:null}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app?tabs=certificate"},"Register a new application")," for the chatbot (if not already registered).  ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Copy and save the ",(0,o.kt)("strong",{parentName:"p"},"Application/Client ID")," and ",(0,o.kt)("strong",{parentName:"p"},"Tenant ID")," from the ",(0,o.kt)("strong",{parentName:"p"},"Overview")," section.",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/CcHq8fL.png",alt:null}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Navigate to ",(0,o.kt)("strong",{parentName:"p"},"Certificates & Secrets"),":  "),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"New Client Secret"),".  "),(0,o.kt)("li",{parentName:"ul"},"Provide a description and set the expiration to ",(0,o.kt)("strong",{parentName:"li"},"Never"),".  "),(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Add"),", and copy the generated Client Secret for future use."))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go to ",(0,o.kt)("strong",{parentName:"p"},"Authentication"),":  "),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Add a Platform")," > ",(0,o.kt)("strong",{parentName:"li"},"Web"),".  "),(0,o.kt)("li",{parentName:"ul"},"Add the Redirect URL:",(0,o.kt)("br",{parentName:"li"}),(0,o.kt)("inlineCode",{parentName:"li"},"https://app.yellowmessenger.com/integrations/azureauth/"),"  "),(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Save"),"."))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Configure Permissions:  "),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Navigate to ",(0,o.kt)("strong",{parentName:"li"},"API Permissions")," > ",(0,o.kt)("strong",{parentName:"li"},"Add Permission"),".  "),(0,o.kt)("li",{parentName:"ul"},"Add the following common permissions and grant ",(0,o.kt)("strong",{parentName:"li"},"Admin Consent"),":")),(0,o.kt)("table",{parentName:"li"},(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Scope")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Description")))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"openid, email, profile, User.Read"),(0,o.kt)("td",{parentName:"tr",align:null},"Retrieve login details and user profiles using Graph API.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"offline_access"),(0,o.kt)("td",{parentName:"tr",align:null},"Required for refresh token retrieval.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"User.Read.All"),(0,o.kt)("td",{parentName:"tr",align:null},"Read user profiles in the tenant.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Calendars.ReadWrite"),(0,o.kt)("td",{parentName:"tr",align:null},"Modify user calendars and meetings.")))),(0,o.kt)("p",{parentName:"li"},"For more details, refer to the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/permissions-reference"},"Graph Permissions Guide"),"."))),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"steps-to-integrate-azure-app-with-yellowai-bot"},(0,o.kt)("strong",{parentName:"h3"},"Steps to Integrate Azure App with Yellow.ai Bot")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the Yellow.ai platform, navigate to the ",(0,o.kt)("strong",{parentName:"p"},"Development")," or ",(0,o.kt)("strong",{parentName:"p"},"Staging")," environment:  "),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Go to ",(0,o.kt)("strong",{parentName:"li"},"Extensions")," > ",(0,o.kt)("strong",{parentName:"li"},"Integrations")," > ",(0,o.kt)("strong",{parentName:"li"},"Tools & Utilities")," > ",(0,o.kt)("strong",{parentName:"li"},"Azure"),".  "),(0,o.kt)("li",{parentName:"ul"},"Use the search box if needed.",(0,o.kt)("br",{parentName:"li"}),(0,o.kt)("img",{parentName:"li",src:"https://i.imgur.com/UG4GJpt.png",alt:null})))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the ",(0,o.kt)("strong",{parentName:"p"},"Account Name")," field, provide a unique name for the integration (use lowercase alphanumeric characters and underscores only).  ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter the following details obtained from Azure AD:  "),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Tenant ID"),"  "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Client ID"),"  "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Client Secret")))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Set the API version to ",(0,o.kt)("strong",{parentName:"p"},"v2.0"),".  ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Specify the required ",(0,o.kt)("strong",{parentName:"p"},"Scope")," (e.g., ",(0,o.kt)("inlineCode",{parentName:"p"},"Calendars.ReadWrite offline_access User.Read"),").  ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Connect"),".",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/IfoUcrn.png",alt:null}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"To connect additional accounts, click ",(0,o.kt)("strong",{parentName:"p"},"+ Add Account")," and repeat the steps above. A maximum of 15 accounts can be added."))),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"authentication-workflow"},(0,o.kt)("strong",{parentName:"h3"},"Authentication Workflow")),(0,o.kt)("p",null,"When a user initiates authentication via Azure AD:  "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The bot redirects the user to the ",(0,o.kt)("strong",{parentName:"li"},"Active Directory login page"),".  "),(0,o.kt)("li",{parentName:"ol"},"After entering their credentials, AD validates them.  "),(0,o.kt)("li",{parentName:"ol"},"Upon successful authentication, Azure AD sends a callback to Yellow.ai with:  ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Access Token"),"  "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Refresh Token"),"  "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Token Expiry Details"))))),(0,o.kt)("h4",{id:"access-token-usage"},(0,o.kt)("strong",{parentName:"h4"},"Access Token Usage")),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},"Access Token")," allows secure access to resources within the permissions granted. Note: Tokens expire in 1 hour but can be refreshed using the ",(0,o.kt)("strong",{parentName:"p"},"Refresh Token")," for up to 90 days."),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"retrieve-user-profile-via-graph-api"},(0,o.kt)("strong",{parentName:"h3"},"Retrieve User Profile via Graph API")),(0,o.kt)("p",null,"To fetch user details using the ",(0,o.kt)("strong",{parentName:"p"},"Access Token"),", send a GET request to the Microsoft Graph API:"),(0,o.kt)("h4",{id:"request"},(0,o.kt)("strong",{parentName:"h4"},"Request:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl --location --request GET 'https://graph.microsoft.com/v1.0/me' \\\n--header 'Authorization: Bearer {accessToken}'\n")),(0,o.kt)("h4",{id:"response-example"},(0,o.kt)("strong",{parentName:"h4"},"Response Example:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",\n  "businessPhones": [],\n  "displayName": "Shubhi Saxena",\n  "givenName": "Shubhi",\n  "jobTitle": null,\n  "mail": "shubhi@bitonictexxxxxxx.onmicrosoft.com",\n  "mobilePhone": null,\n  "surname": "Saxena",\n  "userPrincipalName": "shubhi@bitonictexxxxxxx.onmicrosoft.com",\n  "id": "e4a5dbe5-4750-41e7-8axxxxxxxxx"\n}\n')),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"other-useful-graph-apis"},(0,o.kt)("strong",{parentName:"h3"},"Other Useful Graph APIs")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/api/user-list-events?view=graph-rest-1.0&tabs=http"},"Get User Events"),"  "),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http"},"Send Email on Behalf of a User"),"  "),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/api/planneruser-list-tasks?view=graph-rest-1.0&tabs=http"},"Retrieve User Tasks"),"  "),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/api/resources/passwordprofile?view=graph-rest-1.0"},"Update Password"))),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"resources-for-exploration"},(0,o.kt)("strong",{parentName:"h3"},"Resources for Exploration")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0"},"Microsoft Graph API Documentation"),"  "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://developer.microsoft.com/en-us/graph/graph-explorer"},"Graph Explorer"))),(0,o.kt)("hr",null),(0,o.kt)("p",null,"This version ensures clarity, professionalism, and adherence to documentation standards. It is structured for easy navigation and a seamless user experience."),(0,o.kt)("h2",{id:"app-registration-on-aad"},"App Registration on AAD"),(0,o.kt)("p",null,"For connecting Azure AD with YM bot, following details need to be obtained using AD App registration:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Client ID / Application ID"),(0,o.kt)("li",{parentName:"ol"},"Tenant ID"),(0,o.kt)("li",{parentName:"ol"},"Client Secret")),(0,o.kt)("h2",{id:"steps-to-configure-app-in-azure-ad"},"Steps to configure App in Azure AD"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go to ",(0,o.kt)("a",{parentName:"p",href:"https://portal.azure.com/"},"portal.azure.com")," > Active Directory > App Registrations."),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/CcHq8fL.png",alt:null})))),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app?tabs=certificate"},"Register a new app")," for the chatbot (if not already registered)")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Copy and Save the Application/Client ID and tenant ID from overview section."))),(0,o.kt)("p",null,"   ",(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/CcHq8fL.png",alt:null})),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go to Certificates & Secrets > New client secret > Fill the description & select expires to Never, After clicking on Add button a Client Secret will be generated, save the value of the Client Secret.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Goto ",(0,o.kt)("strong",{parentName:"p"},"Authentication")," > ",(0,o.kt)("strong",{parentName:"p"},"Add a platform")," > ",(0,o.kt)("strong",{parentName:"p"},"Web")," > ",(0,o.kt)("strong",{parentName:"p"},"Add the redirect URL")," > ",(0,o.kt)("strong",{parentName:"p"},"Save"),"."),(0,o.kt)("p",{parentName:"li"},"Redirect-Url: ",(0,o.kt)("inlineCode",{parentName:"p"},"https://app.yellowmessenger.com/integrations/azureauth/"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Add/Remove permission and Grant Admin consent for the App.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go to API Permissions > Add the required permissions."))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Common permission:")),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Scope"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"openid, email, profile, User.Read"),(0,o.kt)("td",{parentName:"tr",align:null},"Used to retrieve login details & their profile using Graph Api")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"offline_access"),(0,o.kt)("td",{parentName:"tr",align:null},"Required to obtain refresh token")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"User.Read.All"),(0,o.kt)("td",{parentName:"tr",align:null},"Read profile of all the user in the tenant.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Calendars.ReadWrite"),(0,o.kt)("td",{parentName:"tr",align:null},"Edit User\u2019s calendar / meetings")))),(0,o.kt)("p",null,"Graph Permission: ",(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/permissions-reference"},"https://docs.microsoft.com/en-us/graph/permissions-reference")),(0,o.kt)("h2",{id:"steps-to-integrate-azure-app-with-yellowai-bot-1"},"Steps to integrate Azure app with yellow.ai bot:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"On the Cloud platform, navigate to Development/Staging environment and go to ",(0,o.kt)("strong",{parentName:"p"},"Extensions")," > ",(0,o.kt)("strong",{parentName:"p"},"Integrations")," > ",(0,o.kt)("strong",{parentName:"p"},"Tools & Utilities")," > ",(0,o.kt)("strong",{parentName:"p"},"Azure"),". Alternatively, you can use the Search box to find a specific integration.\n",(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/UG4GJpt.png",alt:null}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In ",(0,o.kt)("strong",{parentName:"p"},"Give account name"),", enter a unique name for the integration. You can use only lowercase alphanumeric characters and underscores (",(0,o.kt)("inlineCode",{parentName:"p"},"_"),").")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter the obtained ",(0,o.kt)("strong",{parentName:"p"},"Tenant ID"),", ",(0,o.kt)("strong",{parentName:"p"},"Client ID"),", ",(0,o.kt)("strong",{parentName:"p"},"Client Secret"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter the API version to v2.0")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter the required scope.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Connect"),"."))),(0,o.kt)("p",null,"   ",(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/IfoUcrn.png",alt:null})),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"If you want to connect multiple accounts, click ",(0,o.kt)("strong",{parentName:"li"},"+ Add account")," and proceed with the previous steps. You can add a maximum of 15 accounts.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Obtain Azure AD")," ",(0,o.kt)("strong",{parentName:"p"},"Login url:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'let consent = "&prompt=login"  //prompt=login allow user to choose a logging account\n\n{\n   "title": "Login",\n   "url": app.azure.auth() + consent                     \n}\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Response")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'app.log(app.data)\n{\n   "event": {\n       "code": "azure-auth-success",\n       "data": {\n           "token_type": "Bearer",\n           "scope": "Calendars.ReadWrite email openid profile User.Read",\n           "expires_in": 3599,\n           "ext_expires_in": 3599,\n           "access_token": "eyJ0eXXXXXXXXXXXXXXXXX",\n           "refresh_token": "aiJ0eXXXXXXXXXXXXXXXX"\n       }\n   }\n }\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Access Token")," can be used to get access to resources of allowed applications.\nExpire time : 1 hour."),(0,o.kt)("p",null,"Azure allows an expired access-token to be refreshed using the ",(0,o.kt)("strong",{parentName:"p"},"Refresh Token")," for a maximum period of time of 90 days."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Retrieve user profile using AD refresh token & Graph Api")),(0,o.kt)("p",null,"Request"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"curl --location --request GET 'https://graph.microsoft.com/v1.0/me' \\\n--header 'Authorization: Bearer {accessToken}' \\\n")),(0,o.kt)("p",null,"Response"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",\n    "businessPhones": [],\n    "displayName": "Shubhi Saxena",\n    "givenName": "Shubhi",\n    "jobTitle": null,\n    "mail": "shubhi@bitonictexxxxxxx.onmicrosoft.com",\n    "mobilePhone": null,\n    "surname": "Saxena",\n    "userPrincipalName": "shubhi@bitonictexxxxxxx.onmicrosoft.com",\n    "id": "e4a5dbe5-4750-41e7-8axxxxxxxxx"\n}\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Other useful Graph APIs:")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/api/user-list-events?view=graph-rest-1.0&tabs=http"},"Get events of user")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http"},"Send email on behalf of user")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/api/planneruser-list-tasks?view=graph-rest-1.0&tabs=http"},"Load tasks of user")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/api/resources/passwordprofile?view=graph-rest-1.0"},"Update password"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Graph APIs:")),(0,o.kt)("p",null," ",(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-US/graph/api/overview?view=graph-rest-1.0"},"https://docs.microsoft.com/en-US/graph/api/overview?view=graph-rest-1.0")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Graph Explorer:")," ",(0,o.kt)("a",{parentName:"p",href:"https://developer.microsoft.com/en-us/graph/graph-explorer"},"https://developer.microsoft.com/en-us/graph/graph-explorer")),(0,o.kt)("h2",{id:"references"},"References"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/windows-server/identity/ad-fs/overview/whats-new-active-directory-federation-services-windows-server"},"Azure ADFS")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/microsoftteams/platform/tabs/how-to/authentication/auth-flow-tab"},"Active Directory authentication")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-US/graph/api/overview?view=graph-rest-1.0"},"Graph APIs")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app"},"App Registration"))))}k.isMDXComponent=!0}}]);