"use strict";(self.webpackChunkbenthos=self.webpackChunkbenthos||[]).push([[22605],{94144:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"platform_concepts/appConfiguration/azure-ad","title":"Azure AD integration","description":"Azure Active Directory (Azure AD) enhances user management by enabling Single Sign-On (SSO) and personalized app experiences through the use of organizational data APIs. This integration also offers IT administrators comprehensive control over application and resource access, using advanced security features like Multi-Factor Authentication (MFA) and conditional access.","source":"@site/docs/platform_concepts/appConfiguration/azure-ad.md","sourceDirName":"platform_concepts/appConfiguration","slug":"/platform_concepts/appConfiguration/azure-ad","permalink":"/docs/platform_concepts/appConfiguration/azure-ad","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Azure AD integration","sidebar_label":"Azure AD"},"sidebar":"platform_concepts","previous":{"title":"AWS-S3","permalink":"/docs/platform_concepts/appConfiguration/aws-s3"},"next":{"title":"CleverTap","permalink":"/docs/platform_concepts/appConfiguration/clevertap"}}');var i=s(74848),t=s(28453),o=s(21028);const l={title:"Azure AD integration",sidebar_label:"Azure AD"},c=void 0,a={},h=[{value:"Key Features:",id:"key-features",level:4},{value:"Yellow.ai Compatibility:",id:"yellowai-compatibility",level:4},{value:"Authentication Flow:",id:"authentication-flow",level:4},{value:"<strong>App Registration on Azure AD</strong>",id:"app-registration-on-azure-ad",level:2},{value:"<strong>Steps to Configure the App in Azure AD</strong>",id:"steps-to-configure-the-app-in-azure-ad",level:3},{value:"<strong>Steps to Integrate Azure App with Yellow.ai Bot</strong>",id:"steps-to-integrate-azure-app-with-yellowai-bot",level:3},{value:"<strong>Authentication Workflow</strong>",id:"authentication-workflow",level:3},{value:"<strong>Access Token Usage</strong>",id:"access-token-usage",level:4},{value:"Retrieve User Profile via Graph API",id:"retrieve-user-profile-via-graph-api",level:3},{value:"Request:",id:"request",level:4},{value:"Response Example:",id:"response-example",level:4},{value:"<strong>Other Useful Graph APIs</strong>",id:"other-useful-graph-apis",level:3},{value:"<strong>Resources for Exploration</strong>",id:"resources-for-exploration",level:3},{value:"App Registration on AAD",id:"app-registration-on-aad",level:2},{value:"Steps to configure App in Azure AD",id:"steps-to-configure-app-in-azure-ad",level:2},{value:"Steps to integrate Azure app with yellow.ai bot:",id:"steps-to-integrate-azure-app-with-yellowai-bot-1",level:2},{value:"<strong>Obtain Azure AD Login URL</strong>",id:"obtain-azure-ad-login-url",level:3},{value:"<strong>Response</strong>",id:"response",level:3},{value:"<strong>Retrieve User Profile using Azure AD Access Token</strong>",id:"retrieve-user-profile-using-azure-ad-access-token",level:3},{value:"Request",id:"request-1",level:4},{value:"Response",id:"response-1",level:4},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Azure Active Directory (Azure AD) enhances user management by enabling ",(0,i.jsx)(n.strong,{children:"Single Sign-On (SSO)"})," and personalized app experiences through the use of organizational data APIs. This integration also offers IT administrators comprehensive control over application and resource access, using advanced security features like ",(0,i.jsx)(n.strong,{children:"Multi-Factor Authentication (MFA)"})," and conditional access."]}),"\n",(0,i.jsx)(n.h4,{id:"key-features",children:"Key Features:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"SSO for Seamless Access:"})," Azure AD supports integration with over 2,800 pre-configured Software as a Service (SaaS) applications, simplifying access management across systems."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Security and Personalization:"})," Use organization-specific data to create secure, tailored experiences."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"yellowai-compatibility",children:"Yellow.ai Compatibility:"}),"\n",(0,i.jsx)(n.p,{children:"Yellow.ai comes pre-integrated with:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Active Directory Federation Services (ADFS)"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Generic OAuth"})," implementation"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This ensures secure authentication while supporting diverse organizational needs."}),"\n",(0,i.jsx)(n.h4,{id:"authentication-flow",children:"Authentication Flow:"}),"\n",(0,i.jsx)(n.p,{children:"When ADFS is enabled:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["The bot redirects you to the ",(0,i.jsx)(n.strong,{children:"Active Directory login page"})," for credential input."]}),"\n",(0,i.jsx)(n.li,{children:"AD validates the credentials."}),"\n",(0,i.jsx)(n.li,{children:"Upon successful authentication, ADFS triggers a callback to Yellow.ai to indicate the result."}),"\n",(0,i.jsxs)(n.li,{children:["If authentication succeeds, ADFS generates:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["An ",(0,i.jsx)(n.strong,{children:"authentication token"})]}),"\n",(0,i.jsxs)(n.li,{children:["A ",(0,i.jsx)(n.strong,{children:"refresh token"})]}),"\n",(0,i.jsxs)(n.li,{children:["The token\u2019s ",(0,i.jsx)(n.strong,{children:"time-to-live (TTL)"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"These tokens allow secure access while maintaining control over session duration."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"app-registration-on-azure-ad",children:(0,i.jsx)(n.strong,{children:"App Registration on Azure AD"})}),"\n",(0,i.jsx)(n.p,{children:"To connect Azure AD with your Yellow.ai bot, you must first register an app in Azure AD and retrieve the following details:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Client ID"})," (Application ID)"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Tenant ID"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Client Secret"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"steps-to-configure-the-app-in-azure-ad",children:(0,i.jsx)(n.strong,{children:"Steps to Configure the App in Azure AD"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Log in to ",(0,i.jsx)(n.a,{href:"https://portal.azure.com",children:"Azure Portal"})," and navigate to ",(0,i.jsx)(n.strong,{children:"Active Directory"})," > ",(0,i.jsx)(n.strong,{children:"App Registrations"}),".",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.img,{src:"https://i.imgur.com/CcHq8fL.png",alt:""})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app?tabs=certificate",children:"Register a new application"})," for the chatbot (if not already registered)."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Copy and save the ",(0,i.jsx)(n.strong,{children:"Application/Client ID"})," and ",(0,i.jsx)(n.strong,{children:"Tenant ID"})," from the ",(0,i.jsx)(n.strong,{children:"Overview"})," section.",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.img,{src:"https://i.imgur.com/CcHq8fL.png",alt:""})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Navigate to ",(0,i.jsx)(n.strong,{children:"Certificates & Secrets"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"New Client Secret"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Provide a description and set the expiration to ",(0,i.jsx)(n.strong,{children:"Never"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Add"}),", and copy the generated Client Secret for future use."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Go to ",(0,i.jsx)(n.strong,{children:"Authentication"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Add a Platform"})," > ",(0,i.jsx)(n.strong,{children:"Web"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Add the Redirect URL:",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.code,{children:"https://app.yellowmessenger.com/integrations/azureauth/"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Save"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Configure Permissions:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Navigate to ",(0,i.jsx)(n.strong,{children:"API Permissions"})," > ",(0,i.jsx)(n.strong,{children:"Add Permission"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Add the following common permissions and grant ",(0,i.jsx)(n.strong,{children:"Admin Consent"}),":"]}),"\n"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Scope"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Description"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"openid, email, profile, User.Read"}),(0,i.jsx)(n.td,{children:"Retrieve login details and user profiles using Graph API."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"offline_access"}),(0,i.jsx)(n.td,{children:"Required for refresh token retrieval."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"User.Read.All"}),(0,i.jsx)(n.td,{children:"Read user profiles in the tenant."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Calendars.ReadWrite"}),(0,i.jsx)(n.td,{children:"Modify user calendars and meetings."})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["For more details, refer to the ",(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/permissions-reference",children:"Graph Permissions Guide"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"steps-to-integrate-azure-app-with-yellowai-bot",children:(0,i.jsx)(n.strong,{children:"Steps to Integrate Azure App with Yellow.ai Bot"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the Yellow.ai platform, navigate to the ",(0,i.jsx)(n.strong,{children:"Development"})," or ",(0,i.jsx)(n.strong,{children:"Staging"})," environment:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.strong,{children:"Extensions"})," > ",(0,i.jsx)(n.strong,{children:"Integrations"})," > ",(0,i.jsx)(n.strong,{children:"Tools & Utilities"})," > ",(0,i.jsx)(n.strong,{children:"Azure"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Use the search box if needed.",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.img,{src:"https://i.imgur.com/UG4GJpt.png",alt:""})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.strong,{children:"Account Name"})," field, provide a unique name for the integration (use lowercase alphanumeric characters and underscores only)."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Enter the following details obtained from Azure AD:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Tenant ID"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Client ID"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Client Secret"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Set the API version to ",(0,i.jsx)(n.strong,{children:"v2.0"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Specify the required ",(0,i.jsx)(n.strong,{children:"Scope"})," (e.g., ",(0,i.jsx)(n.code,{children:"Calendars.ReadWrite offline_access User.Read"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Connect"}),".",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.img,{src:"https://i.imgur.com/IfoUcrn.png",alt:""})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["To connect additional accounts, click ",(0,i.jsx)(n.strong,{children:"+ Add Account"})," and repeat the steps above. A maximum of 15 accounts can be added."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"authentication-workflow",children:(0,i.jsx)(n.strong,{children:"Authentication Workflow"})}),"\n",(0,i.jsx)(n.p,{children:"When a user initiates authentication via Azure AD:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["The bot redirects the user to the ",(0,i.jsx)(n.strong,{children:"Active Directory login page"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"After entering their credentials, AD validates them."}),"\n",(0,i.jsxs)(n.li,{children:["Upon successful authentication, Azure AD sends a callback to Yellow.ai with:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Access Token"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Refresh Token"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Token Expiry Details"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"access-token-usage",children:(0,i.jsx)(n.strong,{children:"Access Token Usage"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Access Token"})," allows secure access to resources within the permissions granted. Note: Tokens expire in 1 hour but can be refreshed using the ",(0,i.jsx)(n.strong,{children:"Refresh Token"})," for up to 90 days."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"retrieve-user-profile-via-graph-api",children:"Retrieve User Profile via Graph API"}),"\n",(0,i.jsxs)(n.p,{children:["To fetch user details using the ",(0,i.jsx)(n.strong,{children:"Access Token"}),", send a GET request to the Microsoft Graph API:"]}),"\n",(0,i.jsx)(n.h4,{id:"request",children:"Request:"}),"\n",(0,i.jsx)(o.A,{language:"bash",children:"curl --location --request GET 'https://graph.microsoft.com/v1.0/me' \\\n--header 'Authorization: Bearer {accessToken}'"}),"\n",(0,i.jsx)(n.h4,{id:"response-example",children:"Response Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "@odata.context": "[https://graph.microsoft.com/v1.0/$metadata#users/$entity](https://graph.microsoft.com/v1.0/$metadata#users/$entity)",\n  "businessPhones": [],\n  "displayName": "Shubhi Saxena",\n  "givenName": "Shubhi",\n  "jobTitle": null,\n  "mail": "shubhi@bitonictexxxxxxx.onmicrosoft.com",\n  "mobilePhone": null,\n  "surname": "Saxena",\n  "userPrincipalName": "shubhi@bitonictexxxxxxx.onmicrosoft.com",\n  "id": "e4a5dbe5-4750-41e7-8axxxxxxxxx"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"other-useful-graph-apis",children:(0,i.jsx)(n.strong,{children:"Other Useful Graph APIs"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/api/user-list-events?view=graph-rest-1.0&tabs=http",children:"Get User Events"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http",children:"Send Email on Behalf of a User"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/api/planneruser-list-tasks?view=graph-rest-1.0&tabs=http",children:"Retrieve User Tasks"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/api/resources/passwordprofile?view=graph-rest-1.0",children:"Update Password"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"resources-for-exploration",children:(0,i.jsx)(n.strong,{children:"Resources for Exploration"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0",children:"Microsoft Graph API Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://developer.microsoft.com/en-us/graph/graph-explorer",children:"Graph Explorer"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"This version ensures clarity, professionalism, and adherence to documentation standards. It is structured for easy navigation and a seamless user experience."}),"\n",(0,i.jsx)(n.h2,{id:"app-registration-on-aad",children:"App Registration on AAD"}),"\n",(0,i.jsx)(n.p,{children:"For connecting Azure AD with YM bot, following details need to be obtained using AD App registration:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Client ID / Application ID"}),"\n",(0,i.jsx)(n.li,{children:"Tenant ID"}),"\n",(0,i.jsx)(n.li,{children:"Client Secret"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"steps-to-configure-app-in-azure-ad",children:"Steps to configure App in Azure AD"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Go to ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/",children:"portal.azure.com"})," > Active Directory > App Registrations."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://i.imgur.com/CcHq8fL.png",alt:""})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app?tabs=certificate",children:"Register a new app"})," for the chatbot (if not already registered)"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Copy and Save the Application/Client ID and tenant ID from overview section."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://i.imgur.com/CcHq8fL.png",alt:""})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Go to Certificates & Secrets > New client secret > Fill the description & select expires to Never, After clicking on Add button a Client Secret will be generated, save the value of the Client Secret."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Goto ",(0,i.jsx)(n.strong,{children:"Authentication"})," > ",(0,i.jsx)(n.strong,{children:"Add a platform"})," > ",(0,i.jsx)(n.strong,{children:"Web"})," > ",(0,i.jsx)(n.strong,{children:"Add the redirect URL"})," > ",(0,i.jsx)(n.strong,{children:"Save"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Redirect-Url: ",(0,i.jsx)(n.code,{children:"https://app.yellowmessenger.com/integrations/azureauth/"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Add/Remove permission and Grant Admin consent for the App."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Go to API Permissions > Add the required permissions."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Common permission:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Scope"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"openid, email, profile, User.Read"}),(0,i.jsx)(n.td,{children:"Used to retrieve login details & their profile using Graph Api"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"offline_access"}),(0,i.jsx)(n.td,{children:"Required to obtain refresh token"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"User.Read.All"}),(0,i.jsx)(n.td,{children:"Read profile of all the user in the tenant."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Calendars.ReadWrite"}),(0,i.jsx)(n.td,{children:"Edit User\u2019s calendar / meetings"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Graph Permission: ",(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/permissions-reference",children:"https://docs.microsoft.com/en-us/graph/permissions-reference"})]}),"\n",(0,i.jsx)(n.h2,{id:"steps-to-integrate-azure-app-with-yellowai-bot-1",children:"Steps to integrate Azure app with yellow.ai bot:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["On the Cloud platform, navigate to Development/Staging environment and go to ",(0,i.jsx)(n.strong,{children:"Extensions"})," > ",(0,i.jsx)(n.strong,{children:"Integrations"})," > ",(0,i.jsx)(n.strong,{children:"Tools & Utilities"})," > ",(0,i.jsx)(n.strong,{children:"Azure"}),". Alternatively, you can use the Search box to find a specific integration.\n",(0,i.jsx)(n.img,{src:"https://i.imgur.com/UG4GJpt.png",alt:""})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In ",(0,i.jsx)(n.strong,{children:"Give account name"}),", enter a unique name for the integration. You can use only lowercase alphanumeric characters and underscores (",(0,i.jsx)(n.code,{children:"_"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Enter the obtained ",(0,i.jsx)(n.strong,{children:"Tenant ID"}),", ",(0,i.jsx)(n.strong,{children:"Client ID"}),", ",(0,i.jsx)(n.strong,{children:"Client Secret"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Enter the API version to v2.0"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Enter the required scope."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Connect"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://i.imgur.com/IfoUcrn.png",alt:""})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If you want to connect multiple accounts, click ",(0,i.jsx)(n.strong,{children:"+ Add account"})," and proceed with the previous steps. You can add a maximum of 15 accounts."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"obtain-azure-ad-login-url",children:(0,i.jsx)(n.strong,{children:"Obtain Azure AD Login URL"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'let consent = "&prompt=login";  // prompt=login allows user to choose a login account\n\n{\n  "title": "Login",\n  "url": app.azure.auth() + consent\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"response",children:(0,i.jsx)(n.strong,{children:"Response"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'app.log(app.data);\n\n{\n  "event": {\n    "code": "azure-auth-success",\n    "data": {\n      "token_type": "Bearer",\n      "scope": "Calendars.ReadWrite email openid profile User.Read",\n      "expires_in": 3599,\n      "ext_expires_in": 3599,\n      "access_token": "eyJ0eXXXXXXXXXXXXXXXXX",\n      "refresh_token": "aiJ0eXXXXXXXXXXXXXXXX"\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Access Token"})," can be used to access resources of allowed applications.",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Expires in:"})," 1 hour."]}),"\n",(0,i.jsxs)(n.p,{children:["Azure allows an expired access token to be refreshed using the ",(0,i.jsx)(n.strong,{children:"Refresh Token"})," for up to ",(0,i.jsx)(n.strong,{children:"90 days"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"retrieve-user-profile-using-azure-ad-access-token",children:(0,i.jsx)(n.strong,{children:"Retrieve User Profile using Azure AD Access Token"})}),"\n",(0,i.jsx)(n.h4,{id:"request-1",children:"Request"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl --location --request GET 'https://graph.microsoft.com/v1.0/me' \\\n  --header 'Authorization: Bearer `{{accessToken}}`'\n"})}),"\n",(0,i.jsx)(n.h4,{id:"response-1",children:"Response"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",\n  "businessPhones": [],\n  "displayName": "Shubhi Saxena",\n  "givenName": "Shubhi",\n  "jobTitle": null,\n  "mail": "shubhi@bitonictexxxxxxx.onmicrosoft.com",\n  "mobilePhone": null,\n  "surname": "Saxena",\n  "userPrincipalName": "shubhi@bitonictexxxxxxx.onmicrosoft.com",\n  "id": "e4a5dbe5-4750-41e7-8axxxxxxxxx"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Other useful Graph APIs:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/api/user-list-events?view=graph-rest-1.0&tabs=http",children:"Get events of user"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http",children:"Send email on behalf of user"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/api/planneruser-list-tasks?view=graph-rest-1.0&tabs=http",children:"Load tasks of user"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/graph/api/resources/passwordprofile?view=graph-rest-1.0",children:"Update password"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Graph APIs:"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-US/graph/api/overview?view=graph-rest-1.0",children:"https://docs.microsoft.com/en-US/graph/api/overview?view=graph-rest-1.0"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Graph Explorer:"})," ",(0,i.jsx)(n.a,{href:"https://developer.microsoft.com/en-us/graph/graph-explorer",children:"https://developer.microsoft.com/en-us/graph/graph-explorer"})]}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows-server/identity/ad-fs/overview/whats-new-active-directory-federation-services-windows-server",children:"Azure ADFS"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/microsoftteams/platform/tabs/how-to/authentication/auth-flow-tab",children:"Active Directory authentication"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-US/graph/api/overview?view=graph-rest-1.0",children:"Graph APIs"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app",children:"App Registration"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);