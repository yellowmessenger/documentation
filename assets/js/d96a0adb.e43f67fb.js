"use strict";(self.webpackChunkbenthos=self.webpackChunkbenthos||[]).push([[20529],{603905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return g}});var a=t(667294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=a.createContext({}),c=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(l.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(t),m=o,g=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return t?a.createElement(g,i(i({ref:n},p),{},{components:t})):a.createElement(g,i({ref:n},p))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,i=new Array(r);i[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[u]="string"==typeof e?e:o,i[1]=s;for(var c=2;c<r;c++)i[c]=t[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},228033:function(e,n,t){t.r(n),t.d(n,{assets:function(){return p},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return u}});var a=t(487462),o=t(263366),r=(t(667294),t(603905)),i=["components"],s={title:"IVR for app",sidebar_label:"IVR for app"},l=void 0,c={unversionedId:"platform_concepts/channelConfiguration/ivr-bots",id:"platform_concepts/channelConfiguration/ivr-bots",title:"IVR for app",description:"All the bots created after July 2022 operate on the cloud. Refer to this article for the latest update.",source:"@site/docs/platform_concepts/channelConfiguration/ivr-bots.md",sourceDirName:"platform_concepts/channelConfiguration",slug:"/platform_concepts/channelConfiguration/ivr-bots",permalink:"/docs/platform_concepts/channelConfiguration/ivr-bots",draft:!1,tags:[],version:"current",frontMatter:{title:"IVR for app",sidebar_label:"IVR for app"},sidebar:"platform_concepts",previous:{title:"Voice Channels",permalink:"/docs/platform_concepts/channelConfiguration/voice-overview"},next:{title:"IVR for cloud",permalink:"/docs/platform_concepts/channelConfiguration/Ivr"}},p={},u=[{value:"Connect bot to an IVR number",id:"connect-bot-to-an-ivr-number",level:2},{value:"Configure IVR bot",id:"configure-ivr-bot",level:2},{value:"Options and customization to configure voice in app",id:"options-and-customization-to-configure-voice-in-app",level:2},{value:"Bot Options",id:"bot-options",level:3},{value:"Voice Options",id:"voice-options",level:3},{value:"<strong>Change bot&#39;s language</strong>",id:"change-bots-language",level:4},{value:"<strong>Add custom handler </strong>",id:"add-custom-handler-",level:4},{value:"API for IVR Bot Testing",id:"api-for-ivr-bot-testing",level:2}],d={toc:u};function m(e){var n=e.components,t=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"All the bots created after July 2022 operate on the cloud. Refer to ",(0,r.kt)("a",{parentName:"p",href:"/docs/platform_concepts/channelConfiguration/Ivr"},"this")," article for the latest update.")),(0,r.kt)("p",null,"Interactive Voice Response (IVR) bots are designed to interact with users through the phone using audio instructions. IVR systems use pre-recorded or synthesized voice messages to gather information from callers. IVR bots can be used to collect and analyze data, provide callers with accurate information, and connect calls to relevant live agents."),(0,r.kt)("p",null,"There are two ways to connect users to a voice bot:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"PRI (Primary Rate Interface) - A PRI is the number used when the user wants to call the bot. Businesses can use PRI numbers to connect their phone system to an IVR bot. The IVR bot responds to incoming calls on the PRI number and instructs users through an automated menu system.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"SIP (Session Initiation Protocol) - A SIP  number has more functionality, comes with noise cancellation, and can be used when a bot calls the user. By configuring a SIP number, an IVR bot can interact with users, respond to incoming calls to collect input, and perform automated tasks."))),(0,r.kt)("h2",{id:"connect-bot-to-an-ivr-number"},"Connect bot to an IVR number"),(0,r.kt)("p",null,"To connect a bot to an IVR number, follow these steps:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to\n",(0,r.kt)("a",{parentName:"p",href:"https://app.yellowmessenger.com"},"botplatform.io"),"  platform and use cookie chrome extensions like ",(0,r.kt)("inlineCode",{parentName:"p"},"EditThisCookie")," or other processes to login.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy and paste the ",(0,r.kt)("inlineCode",{parentName:"p"},"ym_xid")," cookie value and click the refresh icon to login to the bot.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Go to IVR setup and add a phone number by prefixing +91 with the country code."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/XsgcZBt.png",alt:null})))),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"IVR setup is available only to Indian phone numbers. "))),(0,r.kt)("h2",{id:"configure-ivr-bot"},"Configure IVR bot"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Voice bot gets initiated with a ",(0,r.kt)("strong",{parentName:"li"},"welcome")," message that is captured in the main function using ",(0,r.kt)("inlineCode",{parentName:"li"},"app.data.message"),".  This will store the data when a user calls the bot. ")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"app.data.message // welcome\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"You can train ",(0,r.kt)("strong",{parentName:"p"},"welcome")," for default or initial flow."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://cdn.yellowmessenger.com/6u4HhK6tnD4U1612444738132.png",alt:null})," ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The same bot user can call the bot multiple times.\nYou can choose to clear the data by identifying the previous conversation between the bot and the user by using 'app.clearContext'.\nAfter adding this, each call will be addressed as a new call. Use the sample code to configure voice bot on app: "))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'app.getContext() // get context in main app.context doesn\'t work in main function\n    .then(ctx => {\n\n        if (app.data && app.data.message == "welcome") {\n            app.clearContext() //clear context\n           }\n        });\n      \n')),(0,r.kt)("h2",{id:"options-and-customization-to-configure-voice-in-app"},"Options and customization to configure voice in app"),(0,r.kt)("h3",{id:"bot-options"},"Bot Options"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"voiceOptions: {\n                    'voice_id': 'male' // for male voice in wavelet, comment out if you want a female voice \n                    'recording_max_duration': 2,\n                    'recording_silence_duration': 2,\n                }\n")),(0,r.kt)("p",null,"You need to send the bot's voice options through the app.Start as follows:: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"return app.start({\n                voiceOptions: {\n                    'voice_id': 'male'// for male voice in wavelet, comment out if you want a female voice\n                    'recording_max_duration': 2,\n                    'recording_silence_duration': 2,\n                },\n                targetLanguage: \"en-GB\",\n                minConfidence: 0.6\n            });\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Total Code in Main Function")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"app.getContext()\n    .then(ctx => {\n\n        if (app.data && app.data.message == \"welcome\") {\n            app.clearContext()\n            app.memory.set(\"otpCount\",0)\n            return app.start({\n                voiceOptions: {\n                    'voice_id': 'male',// for male voice in wavelet, comment out if you want a female voice                    'recording_max_duration': 2,\n                    'recording_max_duration': 2,\n                    'recording_silence_duration': 2,\n                },\n                targetLanguage: \"en-GB\",// use en if not needed any other language\n                minConfidence: 0.6\n            });\n        }\n        else {\n            return app.start({\n                voiceOptions: {\n                    'voice_id': 'male',// for male voice in wavelet, comment out if you want a female voice                    'recording_max_duration': 2,\n                    'recording_max_duration': 2,\n                    'recording_silence_duration': 2,\n                },\n                targetLanguage: \"en-GB\",// use en if not needed any other language\n                minConfidence: 0.6\n            });\n        }\n    })\n")),(0,r.kt)("h3",{id:"voice-options"},"Voice Options"),(0,r.kt)("p",null,"Bot voice options and human voice options are different. You need to send Voice options in app.data.message."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"app.sendTextMessage(\"<message>\",\n{\n    'tts_engine': 'wavenet', // wave is google text to speach\n    'text_type': \"ssml\", \n    'lang': 'en-GB', // language option\n    'speed': 0.9,\n    \"options\": { \"capture_voice\": false },\n    \"capture_dtmf\": true,\n    'disconnect': false // to disconnect call make it true\n})\n")),(0,r.kt)("p",null,"It can be initialised in the main or child function."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"app.CONNECT = {\n    'tts_engine': 'wavenet',\n    'text_type': \"ssml\",\n    'lang': 'en-GB',\n    'speed': 0.9,\n    \"options\": { \"capture_voice\": false },\n    \"capture_dtmf\": true,\n    'disconnect': false\n}\napp.DISCONNECT = {\n    'tts_engine': 'wavenet',\n    'text_type': \"ssml\",\n    'lang': 'en-GB',\n    'speed': 0.9,\n    \"options\": { \"capture_voice\": false },\n    \"capture_dtmf\": true,\n    'disconnect': true\n}\n\napp.getContext()\n    .then(ctx => {\n\n        if (app.data && app.data.message == \"welcome\") {\n            app.clearContext()\n            app.memory.set(\"otpCount\",0)\n            return app.start({\n                voiceOptions: {\n                    //'voice_id': 'male'\n                    'recording_max_duration': 2,\n                    'recording_silence_duration': 2,\n                },\n                targetLanguage: \"en-GB\",\n                minConfidence: 0.6\n            });\n        }\n        else {\n            return app.start({\n                voiceOptions: {\n                    //'voice_id': 'male'\n                    'recording_max_duration': 2,\n                    'recording_silence_duration': 2,\n                },\n                targetLanguage: \"en-GB\",\n                minConfidence: 0.6\n            });\n        }\n    })\n")),(0,r.kt)("p",null,"Usage in any function "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// connecting call normal message\napp.data.message("<message>",app.CONNECT)\n\n// disconnecting call\napp.data.message("<message>",app.DISCONNECT)\n')),(0,r.kt)("h4",{id:"change-bots-language"},(0,r.kt)("strong",{parentName:"h4"},"Change bot's language")),(0,r.kt)("p",null,"For changing bot speech language, you need to pass both voice options and bot voice options."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"\napp.sendTextMessage(\u201c<message>\u201c,\n\n{\n    'tts_engine': 'wavenet',\n    'text_type': \"ssml\",\n    'lang': 'en-GB',\n    'speed': 0.9,\n    \"options\": { \"capture_voice\": false },\n    \"capture_dtmf\": true,\n    'disconnect': false\n})\n\nin main function - \n\nreturn app.start({\n                voiceOptions: {\n                    //'voice_id': 'male'\n                    'recording_max_duration': 2,\n                    'recording_silence_duration': 2,\n                },\n                targetLanguage: \"en-GB\",\n                minConfidence: 0.6\n            });\n\n")),(0,r.kt)("p",null,"Following is the final main function:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"\n\napp.CONNECT = {\n    'tts_engine': 'wavenet',\n    'text_type': \"ssml\",\n    'lang': 'en-GB',// send language options\n    'speed': 0.9,\n    \"options\": { \"capture_voice\": false },\n    \"capture_dtmf\": true,\n    'disconnect': false\n}\napp.DISCONNECT = {\n    'tts_engine': 'wavenet',\n    'text_type': \"ssml\",\n    'lang': 'en-GB',// send language options\n    'speed': 0.9,\n    \"options\": { \"capture_voice\": false },\n    \"capture_dtmf\": true,\n    'disconnect': true\n}\n\napp.getContext()\n    .then(ctx => {\n\n        if (app.data && app.data.message == \"welcome\") {\n            app.clearContext()\n            app.memory.set(\"otpCount\",0)\n            return app.start({\n                voiceOptions: {\n                    //'voice_id': 'male'\n                    'recording_max_duration': 2,\n                    'recording_silence_duration': 2,\n                },\n                targetLanguage: \"en-GB\",\n                minConfidence: 0.6\n            });\n        }\n        else {\n            return app.start({\n                voiceOptions: {\n                    //'voice_id': 'male'\n                    'recording_max_duration': 2,\n                    'recording_silence_duration': 2,\n                },\n                targetLanguage: \"en-GB\",// send language options\n                minConfidence: 0.6\n            });\n        }\n    })\n\napp.sendTextMessage(\"<message>\",\n{\n    'tts_engine': 'wavenet', // wave is google text to speach\n    'text_type': \"ssml\", \n    'lang': 'en-GB', // language option\n    'speed': 0.9,\n    \"options\": { \"capture_voice\": true },\n    //\"capture_dtmf\": true,\n    'disconnect': false // to disconnect call make it true\n})\n")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Use this\xa0",(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/text-to-speech"},"link")," to find supported languages and to test samples of code. It is recommended to use only (en-code) en-US, not en-US-Wavenet-D."),(0,r.kt)("li",{parentName:"ul"},"This segment in the link will take some time to load. Ensure that you wait until the full page is loaded."))),(0,r.kt)("h4",{id:"add-custom-handler-"},(0,r.kt)("strong",{parentName:"h4"},"Add custom handler ")),(0,r.kt)("p",null,"The custom handler does not work if you use other language."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},' app.sendTextMessage("Please enter a valid 4 digit pin", app.CONNECT)\n            .then(() => {\n                resolve({ success: false }) // use success false\n            })\n        \n')),(0,r.kt)("h2",{id:"api-for-ivr-bot-testing"},"API for IVR Bot Testing"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'curl --location --request POST \'https://app.yellowmessenger.com/integrations/voice/execute\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Content-Type: text/plain\' \\\n--data-raw \'{\n    "from": "+918328485704",\n    "to": "+918068402327",\n    "message": "welcome",\n    "language": "en"\n}\'\n')))}m.isMDXComponent=!0}}]);