"use strict";(self.webpackChunkbenthos=self.webpackChunkbenthos||[]).push([[78580],{603905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return h}});var a=r(667294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=a.createContext({}),l=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=l(e.components);return a.createElement(p.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=l(r),m=n,h=c["".concat(p,".").concat(m)]||c[m]||d[m]||o;return r?a.createElement(h,i(i({ref:t},u),{},{components:r})):a.createElement(h,i({ref:t},u))}));function h(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=m;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[c]="string"==typeof e?e:n,i[1]=s;for(var l=2;l<o;l++)i[l]=r[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},618842:function(e,t,r){r.r(t),r.d(t,{assets:function(){return u},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return c}});var a=r(487462),n=r(263366),o=(r(667294),r(603905)),i=["components"],s={title:"Add or update user properties from AI-agent conversations",sidebar_label:"Add/update user properties from AI-agent conversations"},p=void 0,l={unversionedId:"platform_concepts/engagement/cdp/user_data/store_conv_data",id:"platform_concepts/engagement/cdp/user_data/store_conv_data",title:"Add or update user properties from AI-agent conversations",description:"Auto-capturing of location-specific user properties",source:"@site/docs/platform_concepts/engagement/cdp/user_data/store_conv_data.md",sourceDirName:"platform_concepts/engagement/cdp/user_data",slug:"/platform_concepts/engagement/cdp/user_data/store_conv_data",permalink:"/docs/platform_concepts/engagement/cdp/user_data/store_conv_data",draft:!1,tags:[],version:"current",frontMatter:{title:"Add or update user properties from AI-agent conversations",sidebar_label:"Add/update user properties from AI-agent conversations"},sidebar:"platform_concepts",previous:{title:"User identification flow",permalink:"/docs/platform_concepts/engagement/cdp/user_data/userid-flow"},next:{title:"Personalise conversations with user properties",permalink:"/docs/platform_concepts/engagement/cdp/user_data/personalise_conversations"}},u={},c=[{value:"Auto-capturing of location-specific user properties",id:"auto-capturing-of-location-specific-user-properties",level:2},{value:"Different ways to add/update user properties",id:"different-ways-to-addupdate-user-properties",level:2},{value:"Store user properties from AI-agent conversations",id:"store-user-properties-from-ai-agent-conversations",level:3},{value:"To capture property values from other variables",id:"to-capture-property-values-from-other-variables",level:4},{value:"To capture user property values from bot script/function",id:"to-capture-user-property-values-from-bot-scriptfunction",level:3},{value:"Capture user properties from API or integration action payload",id:"capture-user-properties-from-api-or-integration-action-payload",level:3},{value:"Update user properties through AI-agent conversations",id:"update-user-properties-through-ai-agent-conversations",level:2}],d={toc:c};function m(e){var t=e.components,r=(0,n.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"auto-capturing-of-location-specific-user-properties"},"Auto-capturing of location-specific user properties"),(0,o.kt)("p",null,"The system can automatically capture essential user details based on the user's location for both Web and WhatsApp AI-agents."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Channel"),(0,o.kt)("th",{parentName:"tr",align:null},"User properties captured"),(0,o.kt)("th",{parentName:"tr",align:null},"Additional details"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"WhatsApp AI-agent"),(0,o.kt)("td",{parentName:"tr",align:null},"Phone number, Country code"),(0,o.kt)("td",{parentName:"tr",align:null},"Captures ",(0,o.kt)("inlineCode",{parentName:"td"},"country")," using the country code in phone number. However, the system may not capture the user's name in all cases, as the user might not have provided it, or the name might contain numbers or special characters that fail validation for the ",(0,o.kt)("inlineCode",{parentName:"td"},"firstName")," and ",(0,o.kt)("inlineCode",{parentName:"td"},"lastName")," properties.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Web AI-agent"),(0,o.kt)("td",{parentName:"tr",align:null},"Timezone and country code"),(0,o.kt)("td",{parentName:"tr",align:null},"Uses IP address to capture these details.")))),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"This is currently supported for web, and WhatsApp AI-agents.")),(0,o.kt)("h2",{id:"different-ways-to-addupdate-user-properties"},"Different ways to add/update user properties"),(0,o.kt)("p",null,"There are four different ways in which you can capture user properties:"),(0,o.kt)("h3",{id:"store-user-properties-from-ai-agent-conversations"},"Store user properties from AI-agent conversations"),(0,o.kt)("p",null,"In addition to the userId, you can also store other user properties in real-time within the user record. User properties are stored in the current record, which is mapped in User 360. You can utilize these properties to ",(0,o.kt)("a",{parentName:"p",href:"https://docs.yellow.ai/docs/platform_concepts/engagement/cdp/user_data/personalise_conversations"},"create personalized conversations")," with AI-agent users, taking into account their previous interactions and preferences."),(0,o.kt)("p",null,"To store user details (such as name, email address, phone number, and any other relevant information) through the AI-agent, use ",(0,o.kt)("a",{parentName:"p",href:"https://docs.yellow.ai/docs/platform_concepts/studio/build/nodes/prompt-nodes"},"Prompt nodes")," or ",(0,o.kt)("a",{parentName:"p",href:"https://docs.yellow.ai/docs/platform_concepts/studio/build/nodes/action-nodes#22-variables"},"Variables node")," in the AI-agent Builder."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"All user properties captured for a record will be mapped to the user as soon as the `userId' is captured during the session."))),(0,o.kt)("p",null,"To store the user\u2019s response in User 360, in ",(0,o.kt)("strong",{parentName:"p"},"Store Response in"),", choose variables only under ",(0,o.kt)("strong",{parentName:"p"},"User properties"),". If a specific user property is not avilable, ",(0,o.kt)("a",{parentName:"p",href:"https://docs.yellow.ai/docs/platform_concepts/engagement/cdp/user_data/user_properties#custom-user-properties"},"create a custom property")," and use it."),(0,o.kt)("p",null,"   ",(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/h8FfpZE.png",alt:null})),(0,o.kt)("h4",{id:"to-capture-property-values-from-other-variables"},"To capture property values from other variables"),(0,o.kt)("p",null,"   If you want to capture user properties from other variables, use the syntax: ",(0,o.kt)("inlineCode",{parentName:"p"},"{{variables.variableName}}"),"."),(0,o.kt)("img",{src:"https://imgur.com/Giwso6b.png",width:"70%"}),(0,o.kt)("p",null,"   Check out the list of all the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.yellow.ai/docs/platform_concepts/engagement/cdp/user_data/user_properties"},"user properties"),"."),(0,o.kt)("h3",{id:"to-capture-user-property-values-from-bot-scriptfunction"},"To capture user property values from bot script/function"),(0,o.kt)("p",null,"   For example, in the sample script below, to capture the phone number as the userId:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'`<script type="text/javascript">`  \nwindow.ymConfig = {"bot":"x1673261303850","host":"[https://cloud.yellow.ai](https://cloud.yellow.ai/)", "payload":{"name":"Tom","phoneNumber":"9090000000","email":"[tom@example.com](mailto:email@example.com)"},};  \n(function() {  \nvar w = window,  \nic = w.YellowMessenger;  \nif ("function" === typeof ic) ic("reattach_activator"), ic("update", ymConfig);  \nelse {  \nvar d = document,  \ni = function() {  \ni.c(arguments)  \n};  \nfunction l() {  \nvar e = d.createElement("script");  \ne.type = "text/javascript", e.async = !0, e.src = "[https://cdn.yellowmessenger.com/plugin/widget-v2/latest/dist/main.min.js](https://cdn.yellowmessenger.com/plugin/widget-v2/latest/dist/main.min.js)";  \nvar t = d.getElementsByTagName("script")[0];  \nt.parentNode.insertBefore(e, t)  \n}  \ni.q = [], i.c = function(e) {  \ni.q.push(e)  \n}, w.YellowMessenger = i, w.attachEvent ? w.attachEvent("onload", l) : w.addEventListener("load", l, !1)}  \n})();  \n<\/script>\n\n')),(0,o.kt)("p",null,"   You can use the Function node to capture and store the variable in the respective user property."),(0,o.kt)("p",null,"   For instance, here ",(0,o.kt)("inlineCode",{parentName:"p"},"returnId")," is the function name containing the provided code. "),(0,o.kt)("p",null,"   To access property vallues from the ",(0,o.kt)("inlineCode",{parentName:"p"},"payload")," schema above, you can use the syntax: ",(0,o.kt)("inlineCode",{parentName:"p"},"data.profile.payload"),". "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'return new Promise(resolve => {\n   let payload = data.profile.payload\n   if (typeof (payload) === "string") {\n      payload = JSON.parse(payload);\n   }\n   console.log(payload);\n   ymLib.logger.log(payload,"init--Payload");\n   resolve(payload)\n});\n')),(0,o.kt)("p",null,"   Store the response returned by the Function in the corresponding variable, in this case, 'userId`."),(0,o.kt)("img",{src:"https://i.imgur.com/qqltmgO.png",width:"70%"}),(0,o.kt)("h3",{id:"capture-user-properties-from-api-or-integration-action-payload"},"Capture user properties from API or integration action payload"),(0,o.kt)("p",null,"   First, store the payload in an object variable."),(0,o.kt)("img",{src:"https://i.imgur.com/ZdyD8u7.png",width:""}),(0,o.kt)("p",null,"   Sample payload"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'{\n   "name": "Tom",\n   "phoneNumber":"9090000000",\n   "email":"tom@example.com"\n}\n')),(0,o.kt)("p",null,"   To access a specific key value from the object variable, use the syntax:  ",(0,o.kt)("inlineCode",{parentName:"p"},"{{{variables.objVariableName.key}}}")),(0,o.kt)("img",{src:"https://i.imgur.com/vwCUkDo.png",width:"60%"}),(0,o.kt)("p",null,"   For example:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"{{{variables.userData.phoneNumber}}}")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"{{{variables.userData.email}}}"))),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"You can also use SDK APIs to programmatically set user properties and the user ID. "),(0,o.kt)("li",{parentName:"ul"},"You can also make use of Function to extract the required information from a payload. "))),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"update-user-properties-through-ai-agent-conversations"},"Update user properties through AI-agent conversations"),(0,o.kt)("p",null,"Once the user is identified, you can update the user properties (other than userId) using the Prompt or Vaiable nodes."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"You cannot update user ID once captured. If the userId is captured again in a flow, it will map to the existing record if it already exists, or create a new userId if it does not exist. To know about user identification in Builder, see ",(0,o.kt)("a",{parentName:"p",href:"https://docs.yellow.ai/docs/platform_concepts/engagement/cdp/user_data/data_capture_convers"},"How user records are created through conversations & unified in User 360"),".")),(0,o.kt)("p",null,"To update existing user properties:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Capture the user property that you want to update using the Variable node or Prompt node, as explained in ",(0,o.kt)("a",{parentName:"p",href:"#store-user-id-through-builder"},"Store userId through builder"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Store them in the respective User properties, as explained in ",(0,o.kt)("a",{parentName:"p",href:"#store-user-properties-through-builder"},"Store user properties through builder"),"."))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"In Prompt nodes, choose the relevant name under User properties."),(0,o.kt)("center",null," ",(0,o.kt)("img",{src:"https://i.imgur.com/mFz74Ka.png",width:"60%"})))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"In the Variable node, choose the relevant user property or add it manually using the syntax ",(0,o.kt)("inlineCode",{parentName:"p"},"{{user.propertyName}}")),(0,o.kt)("center",null," ",(0,o.kt)("img",{src:"https://i.imgur.com/1MvEa5O.png",width:"60%"}))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Furthermore, learn ",(0,o.kt)("a",{parentName:"p",href:"https://docs.yellow.ai/docs/platform_concepts/engagement/cdp/user_data/userid-flow#custom-property-identifier-flow"},"how to capture variables from Functions, Payload, and Bot script"),". Please note that the process for capturing userId or any  any other user property remains the same."))),(0,o.kt)("hr",null))}m.isMDXComponent=!0}}]);